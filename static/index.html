<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="referrer" content="no-referrer">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>ListenBrainz Wrapped</title>
    <link rel="stylesheet" href="style.css">
    <script defer src="request.js"></script>
  </head>
  <body>
    <main class="page">
      <section class="card card--intro">
        <div class="card__body">
          <h1>ListenBrainz Wrapped</h1>
          <p class="intro-copy">
            Turn your ListenBrainz scrobbles into a shareable poster with your top artists,
            tracks, listening time, and favourite genre from the last 12 months.
          </p>
          <form id="wrapped-form" class="form" autocomplete="off" novalidate>
            <label class="form__label" for="username">ListenBrainz username</label>
            <div class="form__field-group">
              <input
                id="username"
                name="username"
                type="text"
                placeholder="e.g. devmatei"
                required
                minlength="2"
                autocomplete="off"
              >
              <button id="submit" type="submit" class="btn">Generate</button>
            </div>
            <p id="status-message" class="status-message" role="status" aria-live="polite" hidden></p>
          </form>
          <div class="form__secondary-grid">
            <div class="form__secondary">
              <label class="form__label" for="color">Card theme</label>
              <select id="color" name="color">
                <option value="black">Midnight</option>
                <option value="purple">Twilight</option>
                <option value="yellow">Sunrise</option>
                <option value="pink">Bloom</option>
              </select>
            </div>
            <div class="form__secondary">
              <label class="form__label" for="service-select">Wrapped service</label>
              <div class="service-select" data-service-dropdown>
                <button
                  type="button"
                  id="service-select"
                  class="service-select__toggle"
                  aria-haspopup="listbox"
                  aria-expanded="false"
                  data-dropdown-toggle
                >
                  <span class="service-select__current">MusicBrainz</span>
                  <svg
                    class="service-select__chevron"
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    aria-hidden="true"
                  >
                    <path
                      d="M6.5 9l5.5 5 5.5-5"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                </button>
                <ul
                  class="service-select__menu"
                  role="listbox"
                  aria-labelledby="service-select"
                  data-dropdown-menu
                >
                  <li>
                    <button
                      type="button"
                      class="service-select__option"
                      role="option"
                      aria-selected="true"
                      data-value="musicbrainz"
                      data-label="MusicBrainz"
                      data-dropdown-option
                    >
                      MusicBrainz
                    </button>
                  </li>
                  <li>
                    <button
                      type="button"
                      class="service-select__option service-select__option--disabled"
                      role="option"
                      aria-disabled="true"
                      data-value="navidrome"
                      data-label="Navidrome"
                      data-dropdown-option
                    >
                      Navidrome
                      <span class="service-select__tooltip" role="tooltip">In progress :)</span>
                    </button>
                  </li>
                </ul>
                <input type="hidden" id="service" name="service" value="musicbrainz">
              </div>
            </div>
          </div>
          <div class="actions">
            <button id="download" type="button" class="btn btn--secondary" aria-disabled="true">
              Download image
            </button>
            <span id="loading" class="loading" hidden>Preparing your wrapped...</span>
            <span id="download-error" class="error" hidden>
              Download unavailable: artist image could not be loaded.
            </span>
          </div>
        </div>
      </section>

      <section class="card card--preview">
        <div class="card__body">
          <canvas id="canvas" width="1080" height="1920" aria-label="Wrapped preview"></canvas>
        </div>
      </section>

      <section class="card card--details" aria-live="polite">
        <div class="card__body results" hidden>
          <h2>Your highlights</h2>
          <div class="results__grid">
            <div>
              <h3>Top artists</h3>
              <p id="top-artists"></p>
            </div>
            <div>
              <h3>Top tracks</h3>
              <p id="top-tracks"></p>
            </div>
            <div>
              <h3>Minutes listened</h3>
              <p id="listen-time"></p>
            </div>
            <div>
              <h3>Top genre</h3>
              <p id="top-genre"></p>
            </div>
          </div>
        </div>
      </section>
    </main>

    <img id="artist-img" src="img/black.png" alt="" hidden>
  </body>
</html>
